[unix_http_server]
file=%(ENV_PROJECT_ROOT)s/supervisor.sock

[supervisord]
logfile=%(ENV_PROJECT_ROOT)s/logs/supervisord.log
pidfile=%(ENV_PROJECT_ROOT)s/supervisord.pid
childlogdir=%(ENV_PROJECT_ROOT)s/logs
nodaemon=false

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix://%(ENV_PROJECT_ROOT)s/supervisor.sock

# Development Services (autostart=false, start only when needed)
[program:ib-stream-development]
command=%(ENV_PROJECT_ROOT)s/.venv/bin/uvicorn ib_stream.api_server:app --host 0.0.0.0 --port %(ENV_IB_STREAM_DEV_PORT)s --reload
directory=%(ENV_PROJECT_ROOT)s/ib-stream
environment=IB_ENVIRONMENT="development",IB_SERVICE_NAME="ib-stream",PROJECT_ROOT="%(ENV_PROJECT_ROOT)s",IB_HOST="192.168.0.60",IB_PORTS="[4002,4001]",IB_CLIENT_ID="%(ENV_IB_STREAM_DEV_CLIENT_ID)s",IB_CONNECTION_TIMEOUT="10",IB_RECONNECT_ATTEMPTS="5",IB_STREAM_ENABLE_STORAGE="true",IB_STREAM_STORAGE_PATH="storage-dev",IB_STREAM_ENABLE_JSON="true",IB_STREAM_ENABLE_PROTOBUF="false",IB_STREAM_ENABLE_POSTGRES="false",IB_STREAM_ENABLE_METRICS="true",IB_STREAM_ENABLE_BACKGROUND_STREAMING="false",IB_STREAM_TRACKED_CONTRACTS="",IB_STREAM_BUFFER_SIZE="100",IB_STREAM_HOST="0.0.0.0",IB_STREAM_PORT="%(ENV_IB_STREAM_DEV_PORT)s",IB_STREAM_LOG_LEVEL="DEBUG",IB_STREAM_MAX_STREAMS="10"
autostart=false
autorestart=true
startretries=3
user=%(ENV_USER)s
stdout_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-stream-development-stdout.log
stderr_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-stream-development-stderr.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile_backups=5

[program:ib-contract-development]
command=%(ENV_PROJECT_ROOT)s/.venv/bin/uvicorn api_server:app --host 0.0.0.0 --port %(ENV_IB_CONTRACT_DEV_PORT)s --reload
directory=%(ENV_PROJECT_ROOT)s/ib-contract
environment=IB_ENVIRONMENT="development",IB_SERVICE_NAME="ib-contract",PROJECT_ROOT="%(ENV_PROJECT_ROOT)s",IB_HOST="192.168.0.60",IB_PORTS="[4002,4001]",IB_CLIENT_ID="%(ENV_IB_CONTRACT_DEV_CLIENT_ID)s",IB_CONNECTION_TIMEOUT="10",IB_RECONNECT_ATTEMPTS="5",IB_STREAM_ENABLE_STORAGE="true",IB_STREAM_STORAGE_PATH="storage-dev",IB_STREAM_ENABLE_JSON="true",IB_STREAM_ENABLE_PROTOBUF="false",IB_STREAM_ENABLE_POSTGRES="false",IB_STREAM_ENABLE_METRICS="true",IB_STREAM_ENABLE_BACKGROUND_STREAMING="false",IB_STREAM_TRACKED_CONTRACTS="",IB_CONTRACTS_PORT="%(ENV_IB_CONTRACT_DEV_PORT)s"
autostart=false
autorestart=true
startretries=3
user=%(ENV_USER)s
stdout_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-contract-development-stdout.log
stderr_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-contract-development-stderr.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile_backups=5

# Production Services (autostart=false, start only when needed)
[program:ib-stream-production]
command=%(ENV_PROJECT_ROOT)s/.venv/bin/uvicorn ib_stream.api_server:app --host 0.0.0.0 --port %(ENV_IB_STREAM_PROD_PORT)s
directory=%(ENV_PROJECT_ROOT)s/ib-stream
environment=IB_ENVIRONMENT="production",IB_SERVICE_NAME="ib-stream",PROJECT_ROOT="%(ENV_PROJECT_ROOT)s",IB_HOST="localhost",IB_PORTS="4002",IB_CLIENT_ID="%(ENV_IB_STREAM_PROD_CLIENT_ID)s",IB_CONNECTION_TIMEOUT="10",IB_RECONNECT_ATTEMPTS="5",IB_STREAM_ENABLE_STORAGE="true",IB_STREAM_STORAGE_PATH="storage",IB_STREAM_ENABLE_JSON="true",IB_STREAM_ENABLE_PROTOBUF="true",IB_STREAM_ENABLE_POSTGRES="true",IB_STREAM_ENABLE_METRICS="true",IB_STREAM_ENABLE_BACKGROUND_STREAMING="true",IB_STREAM_TRACKED_CONTRACTS="711280073:MNQ:bid_ask;last:24",IB_STREAM_BUFFER_SIZE="1000",IB_STREAM_HOST="0.0.0.0",IB_STREAM_PORT="%(ENV_IB_STREAM_PROD_PORT)s",IB_STREAM_LOG_LEVEL="INFO",IB_STREAM_MAX_STREAMS="100"
autostart=false
autorestart=true
startretries=3
user=%(ENV_USER)s
stdout_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-stream-production-stdout.log
stderr_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-stream-production-stderr.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile_backups=5

[program:ib-contract-production]
command=%(ENV_PROJECT_ROOT)s/.venv/bin/uvicorn api_server:app --host 0.0.0.0 --port %(ENV_IB_CONTRACT_PROD_PORT)s
directory=%(ENV_PROJECT_ROOT)s/ib-contract
environment=IB_ENVIRONMENT="production",IB_SERVICE_NAME="ib-contract",PROJECT_ROOT="%(ENV_PROJECT_ROOT)s",IB_HOST="localhost",IB_PORTS="4002",IB_CLIENT_ID="%(ENV_IB_CONTRACT_PROD_CLIENT_ID)s",IB_CONNECTION_TIMEOUT="10",IB_RECONNECT_ATTEMPTS="5",IB_STREAM_ENABLE_STORAGE="true",IB_STREAM_STORAGE_PATH="storage",IB_STREAM_ENABLE_JSON="true",IB_STREAM_ENABLE_PROTOBUF="true",IB_STREAM_ENABLE_POSTGRES="true",IB_STREAM_ENABLE_METRICS="true",IB_STREAM_ENABLE_BACKGROUND_STREAMING="true",IB_STREAM_TRACKED_CONTRACTS="711280073:MNQ:bid_ask;last:24",IB_CONTRACTS_PORT="%(ENV_IB_CONTRACT_PROD_PORT)s"
autostart=false
autorestart=true
startretries=3
user=%(ENV_USER)s
stdout_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-contract-production-stdout.log
stderr_logfile=%(ENV_PROJECT_ROOT)s/logs/ib-contract-production-stderr.log
stdout_logfile_maxbytes=10MB
stderr_logfile_maxbytes=10MB
stdout_logfile_backups=5
stderr_logfile_backups=5